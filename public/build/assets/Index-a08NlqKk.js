import{A as Ie}from"./AppLayout-BgOVO345.js";import{j as h,f as m,G as ee,s as ge,d as y,a as e,b as v,w as p,l as g,t as d,h as w,F as q,m as Y,o as x,c as ve,n as F,C as Me,i as Be,k as u,z as Z,y as Ee}from"./app-BIFzK2ru.js";import{_ as L,a as Ue}from"./BaseCard-Or1BuTQ0.js";import{_ as I,S as B,B as pe}from"./SelectInput-T2IrN6JD.js";import{_ as Ke}from"./TextAreaInput-B8ty7dPd.js";import{_ as te}from"./AccountInput-DcIA036O.js";import{_ as ae}from"./DateInput-C-WTgSBF.js";import{_ as Oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Re={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-4 mb-4"},Je={class:"flex items-center justify-between mb-4"},ze={class:"flex items-center gap-2"},Ne={key:0,class:"space-y-6"},Ge={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},He={class:"space-y-4"},Le={class:"space-y-2"},qe={class:"grid grid-cols-2 gap-3"},Ye={class:"space-y-2"},Qe={class:"grid grid-cols-3 gap-2"},We={class:"space-y-4"},Xe={key:0,class:"space-y-2"},Ze={class:"grid grid-cols-3 gap-2"},et=["onClick"],tt={class:"text-base mb-1"},at={class:"text-xs"},st={key:1,class:"space-y-2"},nt={class:"grid grid-cols-2 gap-3"},lt={class:"space-y-1"},ot={class:"space-y-1"},rt={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},it={key:0,class:"space-y-2"},ut={key:1,class:"space-y-2"},dt={key:2,class:"space-y-2"},ct={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},mt={class:"space-y-2"},pt={key:2,class:"pt-4 border-t border-gray-200"},gt={class:"flex flex-wrap gap-2"},vt={class:"text-xs"},xt=["onClick"],yt={class:"flex justify-between items-center pt-2"},ft={class:"text-sm text-gray-500"},bt={key:0,class:"text-blue-600 font-medium"},kt={key:1},_t={class:"flex gap-2"},ht={key:1,class:"text-center py-2"},wt={class:"inline-flex items-center gap-2 px-4 py-2 bg-gray-50 rounded-full"},$t={class:"text-sm text-gray-600"},Tt={key:0,class:"font-medium text-blue-600"},St={class:"text-gray-500"},Ct={key:1,class:"text-gray-500"},Ft={__name:"BaseFilter",props:{showTypeFilter:{type:Boolean,default:!0},showAccountFilter:{type:Boolean,default:!0},showCategoryFilter:{type:Boolean,default:!0},showUserFilter:{type:Boolean,default:!0},showStatusFilter:{type:Boolean,default:!1},showAmountFilter:{type:Boolean,default:!0},accounts:{type:Array,default:()=>[]},categories:{type:Array,default:()=>[]},users:{type:Array,default:()=>[]},initialFilters:{type:Object,default:()=>({})}},emits:["filters-change","filters-reset"],setup($,{emit:O}){const b=$,R=O,A=h(!1),o=h({start_date:"",end_date:"",type:"",account_id:"",category_id:"",user_id:"",status:"",min_amount:"",max_amount:"",...b.initialFilters}),S=h(""),_=m(()=>new Date().toISOString().split("T")[0]),M=m(()=>[{label:"Hari Ini",value:"today",getRange:()=>({start:_.value,end:_.value})},{label:"Minggu Ini",value:"this_week",getRange:()=>{const r=new Date;return r.setDate(r.getDate()-r.getDay()),{start:r.toISOString().split("T")[0],end:_.value}}},{label:"Bulan Ini",value:"this_month",getRange:()=>{const r=new Date;return r.setDate(1),{start:r.toISOString().split("T")[0],end:_.value}}},{label:"Bulan Lalu",value:"last_month",getRange:()=>{const r=new Date;r.setMonth(r.getMonth()-1),r.setDate(1);const s=new Date(r.getFullYear(),r.getMonth()+1,0);return{start:r.toISOString().split("T")[0],end:s.toISOString().split("T")[0]}}},{label:"3 Bulan",value:"last_3_months",getRange:()=>{const r=new Date,s=new Date;return s.setMonth(s.getMonth()-3),{start:s.toISOString().split("T")[0],end:r.toISOString().split("T")[0]}}}]),V=m(()=>[{value:"",label:"Semua Jenis"},{value:"income",label:"💰 Pemasukan"},{value:"expense",label:"💸 Pengeluaran"},{value:"savings",label:"🏦 Tabungan"}]),P=m(()=>[{value:"",label:"Semua Akun"},...b.accounts.map(r=>({value:r.id,label:`${r.name} ${r.type==="joint"?"👥":"👤"}`}))]),D=m(()=>[{value:"",label:"Semua Kategori"},...b.categories.map(r=>({value:r.id,label:`${r.name} ${r.type==="joint"?"👥":"👤"}`}))]),C=m(()=>[{value:"",label:"Semua User"},...b.users.map(r=>({value:r.id,label:r.name}))]),k=m(()=>[{value:"",label:"Semua Status"},{value:"active",label:"🟢 Aktif"},{value:"inactive",label:"🔴 Nonaktif"}]),f=m(()=>Object.keys(o.value).some(r=>{const s=o.value[r];return s!==""&&s!==null&&s!==void 0})),c=m(()=>{const r=[];if(o.value.start_date&&o.value.end_date&&r.push({key:"date_range",label:`📅 ${o.value.start_date} s/d ${o.value.end_date}`}),o.value.type){const s=V.value.find(i=>i.value===o.value.type)?.label||o.value.type;r.push({key:"type",label:s.split(" ")[1]})}if(o.value.account_id){const s=b.accounts.find(i=>i.id==o.value.account_id);r.push({key:"account_id",label:`🏦 ${s?.name||"Akun"}`})}if(o.value.category_id){const s=b.categories.find(i=>i.id==o.value.category_id);r.push({key:"category_id",label:`📁 ${s?.name||"Kategori"}`})}if(o.value.user_id){const s=b.users.find(i=>i.id==o.value.user_id);r.push({key:"user_id",label:`👤 ${s?.name||"User"}`})}return o.value.min_amount&&r.push({key:"min_amount",label:`💰 Min: Rp ${parseInt(o.value.min_amount).toLocaleString("id-ID")}`}),o.value.max_amount&&r.push({key:"max_amount",label:`💰 Max: Rp ${parseInt(o.value.max_amount).toLocaleString("id-ID")}`}),r}),j=m(()=>{if(!f.value)return"";const r=[];return o.value.start_date&&o.value.end_date&&r.push("Periode"),o.value.type&&r.push("Jenis"),o.value.account_id&&r.push("Akun"),o.value.category_id&&r.push("Kategori"),(o.value.min_amount||o.value.max_amount)&&r.push("Jumlah"),r.join(", ")}),J=r=>{const s=r.getRange();o.value.start_date=s.start,o.value.end_date=s.end,S.value=r.value,T()},E=()=>{o.value={start_date:"",end_date:"",type:"",account_id:"",category_id:"",user_id:"",status:"",min_amount:"",max_amount:""},S.value="",R("filters-reset",o.value)},z=r=>{r==="date_range"?(o.value.start_date="",o.value.end_date="",S.value=""):o.value[r]="",T()},T=()=>{const r=Object.fromEntries(Object.entries(o.value).filter(([s,i])=>i!==""&&i!==null&&i!==void 0));R("filters-change",r)};return ee(()=>b.initialFilters,r=>{o.value={...o.value,...r}},{deep:!0}),ge(()=>{T()}),(r,s)=>(x(),y("div",Re,[e("div",Je,[s[11]||(s[11]=e("div",{class:"flex items-center gap-3"},[e("span",{class:"text-2xl"},"🔍"),e("div",null,[e("h3",{class:"font-semibold text-gray-800"},"Filter Data"),e("p",{class:"text-sm text-gray-500"},"Saring data berdasarkan kriteria tertentu")])],-1)),e("div",ze,[v(I,{onClick:s[0]||(s[0]=i=>A.value=!A.value),variant:"secondary",size:"sm"},{icon:p(()=>[g(d(A.value?"📕":"📖"),1)]),default:p(()=>[g(" "+d(A.value?"Sembunyikan":"Tampilkan")+" Filter ",1)]),_:1}),v(I,{onClick:E,variant:"outline",size:"sm",disabled:!f.value},{icon:p(()=>[...s[9]||(s[9]=[g("🔄",-1)])]),default:p(()=>[s[10]||(s[10]=g(" Reset ",-1))]),_:1},8,["disabled"])])]),A.value?(x(),y("div",Ne,[e("div",Ge,[e("div",He,[e("div",Le,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700"},[e("span",{class:"flex items-center gap-2"},[e("span",null,"📅"),g(" Periode Tanggal ")])],-1)),e("div",qe,[v(ae,{modelValue:o.value.start_date,"onUpdate:modelValue":[s[1]||(s[1]=i=>o.value.start_date=i),T],placeholder:"Dari Tanggal",max:o.value.end_date||_.value},null,8,["modelValue","max"]),v(ae,{modelValue:o.value.end_date,"onUpdate:modelValue":[s[2]||(s[2]=i=>o.value.end_date=i),T],placeholder:"Sampai Tanggal",min:o.value.start_date,max:_.value},null,8,["modelValue","min","max"])])]),e("div",Ye,[s[13]||(s[13]=e("label",{class:"block text-sm font-medium text-gray-700"},[e("span",{class:"flex items-center gap-2"},[e("span",null,"⚡"),g(" Periode Cepat ")])],-1)),e("div",Qe,[(x(!0),y(q,null,Y(M.value,i=>(x(),ve(I,{key:i.value,onClick:N=>J(i),variant:"outline",size:"xs",class:F(["justify-center",{"bg-blue-100 border-blue-300 text-blue-700":S.value===i.value}])},{default:p(()=>[g(d(i.label),1)]),_:2},1032,["onClick","class"]))),128))])])]),e("div",We,[$.showTypeFilter?(x(),y("div",Xe,[s[14]||(s[14]=e("label",{class:"block text-sm font-medium text-gray-700"},[e("span",{class:"flex items-center gap-2"},[e("span",null,"📊"),g(" Jenis Transaksi ")])],-1)),e("div",Ze,[(x(!0),y(q,null,Y(V.value.filter(i=>i.value!==""),i=>(x(),y("button",{key:i.value,onClick:N=>o.value.type=o.value.type===i.value?"":i.value,class:F(["p-2 rounded-lg border text-center transition-all font-medium text-xs",o.value.type===i.value?(i.value==="income"?"bg-green-100 text-green-700 border-green-400":i.value==="expense"?"bg-red-100 text-red-700 border-red-400":"bg-blue-100 text-blue-700 border-blue-400")+" scale-105 shadow-sm":"bg-white border-gray-200 text-gray-500 hover:scale-102 hover:border-gray-300"])},[e("div",tt,d(i.label.split(" ")[0]),1),e("div",at,d(i.label.split(" ")[1]),1)],10,et))),128))])])):w("",!0),$.showAmountFilter?(x(),y("div",st,[s[17]||(s[17]=e("label",{class:"block text-sm font-medium text-gray-700"},[e("span",{class:"flex items-center gap-2"},[e("span",null,"💰"),g(" Rentang Jumlah ")])],-1)),e("div",nt,[e("div",lt,[v(te,{modelValue:o.value.min_amount,"onUpdate:modelValue":[s[3]||(s[3]=i=>o.value.min_amount=i),T],placeholder:"Minimum","account-type":"account_number"},null,8,["modelValue"]),s[15]||(s[15]=e("p",{class:"text-xs text-gray-500 text-center"},"Min",-1))]),e("div",ot,[v(te,{modelValue:o.value.max_amount,"onUpdate:modelValue":[s[4]||(s[4]=i=>o.value.max_amount=i),T],placeholder:"Maksimum","account-type":"account_number"},null,8,["modelValue"]),s[16]||(s[16]=e("p",{class:"text-xs text-gray-500 text-center"},"Max",-1))])])])):w("",!0)])]),$.showAccountFilter||$.showCategoryFilter||$.showUserFilter?(x(),y("div",rt,[$.showAccountFilter&&$.accounts.length?(x(),y("div",it,[s[18]||(s[18]=e("label",{class:"block text-sm font-medium text-gray-700"},[e("span",{class:"flex items-center gap-2"},[e("span",null,"🏦"),g(" Akun ")])],-1)),v(B,{modelValue:o.value.account_id,"onUpdate:modelValue":[s[5]||(s[5]=i=>o.value.account_id=i),T],options:P.value,placeholder:"Pilih Akun"},null,8,["modelValue","options"])])):w("",!0),$.showCategoryFilter&&$.categories.length?(x(),y("div",ut,[s[19]||(s[19]=e("label",{class:"block text-sm font-medium text-gray-700"},[e("span",{class:"flex items-center gap-2"},[e("span",null,"📁"),g(" Kategori ")])],-1)),v(B,{modelValue:o.value.category_id,"onUpdate:modelValue":[s[6]||(s[6]=i=>o.value.category_id=i),T],options:D.value,placeholder:"Pilih Kategori"},null,8,["modelValue","options"])])):w("",!0),$.showUserFilter?(x(),y("div",dt,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700"},[e("span",{class:"flex items-center gap-2"},[e("span",null,"👤"),g(" Dicatat Oleh ")])],-1)),v(B,{modelValue:o.value.user_id,"onUpdate:modelValue":[s[7]||(s[7]=i=>o.value.user_id=i),T],options:C.value,placeholder:"Pilih User"},null,8,["modelValue","options"])])):w("",!0)])):w("",!0),$.showStatusFilter?(x(),y("div",ct,[e("div",mt,[s[21]||(s[21]=e("label",{class:"block text-sm font-medium text-gray-700"},[e("span",{class:"flex items-center gap-2"},[e("span",null,"🟢"),g(" Status ")])],-1)),v(B,{modelValue:o.value.status,"onUpdate:modelValue":[s[8]||(s[8]=i=>o.value.status=i),T],options:k.value,placeholder:"Pilih Status"},null,8,["modelValue","options"])])])):w("",!0),f.value?(x(),y("div",pt,[s[22]||(s[22]=e("div",{class:"flex items-center gap-2 mb-3"},[e("span",{class:"text-sm font-medium text-gray-700 flex items-center gap-2"},[e("span",null,"🎯"),g(" Filter Aktif: ")])],-1)),e("div",gt,[(x(!0),y(q,null,Y(c.value,i=>(x(),y("span",{key:i.key,class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 text-blue-800 shadow-sm"},[e("span",vt,d(i.label),1),e("button",{onClick:N=>z(i.key),class:"hover:text-blue-600 transition-colors text-xs font-bold",title:"Hapus filter"}," × ",8,xt)]))),128))])])):w("",!0),e("div",yt,[e("div",ft,[f.value?(x(),y("span",bt," 🔍 "+d(c.value.length)+" filter aktif ",1)):(x(),y("span",kt," 📝 Tidak ada filter aktif "))]),e("div",_t,[v(I,{onClick:E,variant:"outline",size:"sm",disabled:!f.value},{icon:p(()=>[...s[23]||(s[23]=[g("🗑️",-1)])]),default:p(()=>[s[24]||(s[24]=g(" Hapus Semua Filter ",-1))]),_:1},8,["disabled"])])])])):(x(),y("div",ht,[e("div",wt,[e("span",$t,[f.value?(x(),y("span",Tt,[g(" 🔍 "+d(c.value.length)+" filter aktif - ",1),e("span",St,d(j.value),1)])):(x(),y("span",Ct,' Klik "Tampilkan Filter" untuk menyaring data '))])])]))]))}},Pt={class:"flex items-center justify-between"},At={key:0,class:"mt-2"},Dt={class:"text-sm text-blue-600 bg-blue-50 px-3 py-1 rounded-full"},Vt={class:"py-2 min-h-screen relative overflow-hidden"},jt={class:"w-full px-4 sm:px-6 lg:px-8 relative z-10"},It={class:"flex items-center justify-between"},Mt={class:"flex items-center gap-3"},Bt={class:"text-xl"},Et={class:"font-medium"},Ut={class:"grid grid-cols-2 lg:grid-cols-4 gap-2 mb-4"},Kt={class:"p-4"},Ot={class:"text-xl font-bold text-gray-800 mb-1"},Rt={class:"text-xs text-gray-500 mt-1"},Jt={class:"p-4"},zt={class:"text-xl font-bold text-gray-800 mb-1"},Nt={class:"text-xs text-gray-500 mt-1"},Gt={class:"p-4"},Ht={class:"p-4"},Lt={class:"text-xl font-bold text-gray-800 mb-1"},qt={class:"grid grid-cols-3 lg:grid-cols-4 gap-2 mb-4"},Yt={class:"flex items-center gap-2"},Qt={class:"text-lg"},Wt={class:"font-medium text-gray-700 text-sm"},Xt={class:"flex items-center gap-2"},Zt={class:"text-lg"},ea={class:"flex items-center gap-2"},ta={class:"font-medium text-gray-700 text-sm"},aa={class:"flex items-center gap-2"},sa={class:"font-medium text-gray-700 text-sm"},na={class:"flex items-center gap-2"},la={class:"font-medium text-gray-700 text-sm"},oa={class:"flex items-center gap-2"},ra={class:"text-lg"},ia={key:1,class:"text-center mt-6"},ua={class:"bg-white/80 backdrop-blur-md rounded-3xl shadow-lg p-8 border border-gray-100"},da={class:"space-y-4 max-h-[60vh] overflow-y-auto pr-2"},ca={class:"grid grid-cols-3 gap-2"},ma=["onClick"],pa={class:"text-lg mb-1"},ga={key:0,class:"mt-2 text-sm text-red-500"},va={class:"text-sm flex items-start gap-2"},xa={class:"text-lg mt-0.5"},ya={class:"block"},fa={key:0,class:"p-2 bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-2xl"},ba={class:"space-y-4"},ka={key:0,class:"p-4 bg-gradient-to-r from-gray-50 to-blue-50 border border-gray-200 rounded-2xl"},_a={class:"grid grid-cols-2 gap-4 text-sm"},ha={class:"font-medium text-gray-800"},wa={class:"font-medium text-gray-800"},$a={class:"font-medium text-gray-800"},Ta={class:"font-medium text-gray-800"},Sa={class:"font-medium text-gray-800"},Ca={class:"col-span-2"},Fa={class:"font-medium text-gray-800"},Pa={__name:"Index",setup($){const O=Me(),b=O.props.auth.user,R=b?.partner?.name??"Pasangan",A=`${b?.name??""} 💕 ${R}`,o=h([]),S=h([]),_=h([]),M=h(!1),V=h(!1),P=h(!1),D=h(!1),C=h(null),k=h(null),f=h(null),c=h({}),j=m(()=>Object.keys(c.value).length===0?o.value:o.value.filter(a=>{if(c.value.start_date&&c.value.end_date){const t=a.transaction_date.split("T")[0];if(t<c.value.start_date||t>c.value.end_date)return!1}return!(c.value.type&&a.type!==c.value.type||c.value.account_id&&a.account_id!=c.value.account_id||c.value.category_id&&a.category_id!=c.value.category_id||c.value.user_id&&a.user_id!=c.value.user_id||c.value.min_amount&&a.amount<parseFloat(c.value.min_amount)||c.value.max_amount&&a.amount>parseFloat(c.value.max_amount))})),J=m(()=>j.value.filter(a=>a.type==="income")),E=m(()=>j.value.filter(a=>a.type==="expense")),z=m(()=>j.value.filter(a=>a.type==="savings")),T=m(()=>j.value.filter(a=>a.user_id===b.id)),r=m(()=>J.value.reduce((a,t)=>a+parseFloat(t.amount),0)),s=m(()=>E.value.reduce((a,t)=>a+parseFloat(t.amount),0)),i=m(()=>z.value.reduce((a,t)=>a+parseFloat(t.amount),0)),N=m(()=>r.value-s.value),se=m(()=>j.value),xe=m(()=>J.value),ye=m(()=>E.value);m(()=>z.value);const fe=m(()=>T.value),be=m(()=>r.value),ke=m(()=>s.value);m(()=>i.value);const U=m(()=>N.value),_e=m(()=>Object.keys(c.value).length>0),ne=m(()=>{if(!_e.value)return"";const a=[];if(c.value.start_date&&c.value.end_date&&a.push(`Periode: ${c.value.start_date} s/d ${c.value.end_date}`),c.value.type){const t={income:"Pemasukan",expense:"Pengeluaran",savings:"Tabungan"}[c.value.type]||c.value.type;a.push(`Jenis: ${t}`)}if(c.value.account_id){const t=S.value.find(n=>n.id==c.value.account_id);a.push(`Akun: ${t?.name||"Terpilih"}`)}if(c.value.category_id){const t=_.value.find(n=>n.id==c.value.category_id);a.push(`Kategori: ${t?.name||"Terpilih"}`)}return a.join(" • ")}),he=a=>{c.value=a},we=()=>{c.value={}},$e=async()=>{await Promise.all([Q(),W()])};ee(()=>O.props.flash,a=>{(a.success||a.error)&&(f.value={message:a.success||a.error,type:a.type||(a.success?"success":"error")},setTimeout(()=>{f.value=null},5e3))},{immediate:!0});const l=Be({type:"expense",account_id:"",category_id:"",amount:0,description:"",transaction_date:new Date().toISOString().split("T")[0]}),Te=[{value:"income",label:"💰 Pemasukan"},{value:"expense",label:"💸 Pengeluaran"},{value:"savings",label:"🏦 Tabungan"}],Se=[{key:"type",label:"Jenis",type:"badge",icon:"📊",sortable:!0,badgeVariant:"romantic"},{key:"amount",label:"Jumlah",icon:"💰",sortable:!0,type:"currency"},{key:"account.name",label:"Akun",icon:"🏦",sortable:!0},{key:"category.name",label:"Kategori",icon:"📁",sortable:!0},{key:"description",label:"Keterangan",icon:"📝",class:"max-w-xs"},{key:"transaction_date",label:"Tanggal",icon:"📅",sortable:!0,type:"date"},{key:"user.name",label:"Dicatat Oleh",icon:"👤",sortable:!0}],Ce=m(()=>({income:"bg-green-50 border-green-200 text-green-800",expense:"bg-red-50 border-red-200 text-red-800",savings:"bg-blue-50 border-blue-200 text-blue-800"})[l.type]||"bg-gray-50 border-gray-200"),Fe=m(()=>({income:"💰",expense:"💸",savings:"🏦"})[l.type]||"📊"),Pe=m(()=>({income:"Pencatatan Pemasukan",expense:"Pencatatan Pengeluaran",savings:"Pencatatan Tabungan"})[l.type]||"Pencatatan Transaksi"),Ae=m(()=>({income:"Catat semua uang yang masuk ke akun kita. Contoh: Gaji, bonus, hadiah, dll.",expense:"Catat semua pengeluaran untuk memantau kebiasaan belanja kita berdua.",savings:"Pindahkan uang ke akun tabungan untuk tujuan masa depan kita."})[l.type]||"Catat transaksi keuangan kita."),G=async()=>{M.value=!0;try{const a=await axios.get(route("transactions.index"));o.value=a.data.transactions||a.data}catch(a){console.error("Error loading transactions:",a),f.value={message:"Gagal memuat data transaksi",type:"error"}}finally{M.value=!1}},Q=async()=>{try{const a=await axios.get(route("transactions.api.accounts"));S.value=a.data,console.log("Accounts loaded:",S.value)}catch(a){console.error("Error loading accounts:",a);try{const t=await axios.get("/api/accounts");S.value=t.data}catch(t){console.error("Fallback also failed:",t),f.value={message:"Gagal memuat data akun",type:"error"}}}},W=async()=>{try{const a=await axios.get(route("transactions.api.categories"));_.value=a.data,console.log("All categories loaded:",_.value)}catch(a){console.error("Error loading categories:",a);try{const t=await axios.get("/api/categories");_.value=t.data}catch(t){console.error("Fallback also failed:",t),f.value={message:"Gagal memuat data kategori",type:"error"}}}},X=m(()=>{if(!_.value.length)return[];const a=l.type==="savings"?"savings":l.type;console.log("Filtering categories for budget type:",a),console.log("All categories:",_.value);const t=_.value.filter(n=>n.budget_type===a);return console.log("Filtered categories:",t),t});ee(()=>l.type,a=>{l.category_id="",console.log("Transaction type changed to:",a)});const le=async()=>{C.value=null,l.reset(),l.type="expense",l.transaction_date=new Date().toISOString().split("T")[0],P.value=!0,await Promise.all([Q(),W()])},oe=async a=>{if(a.user_id!==b.id){f.value={message:"Anda hanya dapat mengedit transaksi yang Anda buat",type:"error"};return}C.value=a,l.type=a.type,l.account_id=a.account_id,l.category_id=a.category_id,l.amount=a.amount,l.description=a.description,l.transaction_date=a.transaction_date.split("T")[0],P.value=!0,await Promise.all([Q(),W()]),setTimeout(()=>{console.log("Current category_id:",l.category_id),console.log("Available categories:",X.value)},100)},re=a=>{if(a.user_id!==b.id){f.value={message:"Anda hanya dapat menghapus transaksi yang Anda buat",type:"error"};return}k.value=a,D.value=!0},De=()=>{if(console.log("Saving transaction:",l),!l.description.trim()){f.value={message:"Keterangan transaksi wajib diisi",type:"error"};return}C.value?l.put(route("transactions.update",C.value.id),{preserveScroll:!0,onSuccess:()=>{P.value=!1,G(),l.reset(),C.value=null},onError:a=>{console.error("Update error:",a),f.value={message:"Gagal memperbarui transaksi",type:"error"}}}):l.post(route("transactions.store"),{preserveScroll:!0,onSuccess:()=>{P.value=!1,G(),l.reset()},onError:a=>{console.error("Create error:",a),f.value={message:"Gagal mencatat transaksi",type:"error"}}})},Ve=()=>{k.value&&(V.value=!0,Ee.delete(route("transactions.destroy",k.value.id),{preserveScroll:!0,onSuccess:()=>{D.value=!1,G(),k.value=null,V.value=!1},onError:a=>{console.error("Delete error:",a),D.value=!1,V.value=!1,f.value={message:"Gagal menghapus transaksi",type:"error"}}}))},je=()=>{P.value=!1,C.value=null,l.clearErrors(),l.reset(),l.type="expense",l.transaction_date=new Date().toISOString().split("T")[0]},ie=a=>({income:"Pemasukan",expense:"Pengeluaran",savings:"Tabungan"})[a]||a,ue=a=>({income:"💰",expense:"💸",savings:"🏦"})[a]||"📊",K=(a,t)=>{const n=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a);return t==="income"?`+ ${n}`:t==="expense"?`- ${n}`:n},de=a=>new Date(a).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}),ce=a=>({income:"text-green-600",expense:"text-red-600",savings:"text-blue-600"})[a]||"text-gray-600",H=a=>a.user_id===b.id;return ge(()=>{G(),$e()}),(a,t)=>(x(),ve(Ie,{title:"Catat Transaksi"},{header:p(()=>[e("div",Pt,[e("div",null,[e("h2",{class:"font-semibold text-2xl text-gray-800 leading-tight flex items-center gap-2"}," 💰 Catat Transaksi Keuangan "+d(A)),ne.value?(x(),y("div",At,[e("span",Dt," 🔍 Filter Aktif: "+d(ne.value),1)])):w("",!0)]),t[9]||(t[9]=e("span",{class:"text-sm text-gray-500 italic"},"Catat setiap pemasukan dan pengeluaran untuk keuangan yang lebih teratur 💞",-1))])]),default:p(()=>[e("div",Vt,[e("div",jt,[f.value?(x(),y("div",{key:0,class:F(["mb-6 p-4 rounded-2xl border backdrop-blur-sm transition-all duration-300",{"bg-green-50 border-green-200 text-green-800":f.value.type==="success","bg-red-50 border-red-200 text-red-800":f.value.type==="error"}])},[e("div",It,[e("div",Mt,[e("span",Bt,d(f.value.type==="success"?"✅":"⚠️"),1),e("span",Et,d(f.value.message),1)]),e("button",{onClick:t[0]||(t[0]=n=>f.value=null),class:"text-gray-500 hover:text-gray-700 transition-colors"}," ✕ ")])],2)):w("",!0),t[43]||(t[43]=e("div",{class:"text-center mb-4"},[e("h1",{class:"text-3xl md:text-4xl font-extrabold text-rose-600 drop-shadow-md mb-3"}," Catat Transaksi Keuangan "),e("p",{class:"text-gray-600 text-lg max-w-2xl mx-auto"},[g(" Pantau semua "),e("span",{class:"text-green-500 font-semibold"},"pemasukan"),g(", "),e("span",{class:"text-red-500 font-semibold"},"pengeluaran"),g(", dan "),e("span",{class:"text-blue-500 font-semibold"},"tabungan"),g(" kita berdua. Setiap transaksi adalah cerita perjalanan keuangan kita 💫 ")])],-1)),v(Ft,{accounts:S.value,categories:_.value,"initial-filters":c.value,onFiltersChange:he,onFiltersReset:we},null,8,["accounts","categories","initial-filters"]),e("div",Ut,[v(L,{class:"text-center hover:scale-[1.02] transition transform border border-green-100"},{default:p(()=>[e("div",Kt,[t[10]||(t[10]=e("div",{class:"w-12 h-12 bg-gradient-to-r from-green-400 to-emerald-500 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-md"},[e("span",{class:"text-xl text-white"},"💰")],-1)),e("h3",Ot,d(K(be.value,"income")),1),t[11]||(t[11]=e("p",{class:"text-sm text-gray-600"},"Pemasukan",-1)),e("p",Rt,d(xe.value.length)+" transaksi",1)])]),_:1}),v(L,{class:"text-center hover:scale-[1.02] transition transform border border-red-100"},{default:p(()=>[e("div",Jt,[t[12]||(t[12]=e("div",{class:"w-12 h-12 bg-gradient-to-r from-red-400 to-pink-500 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-md"},[e("span",{class:"text-xl text-white"},"💸")],-1)),e("h3",zt,d(K(ke.value,"expense")),1),t[13]||(t[13]=e("p",{class:"text-sm text-gray-600"},"Pengeluaran",-1)),e("p",Nt,d(ye.value.length)+" transaksi",1)])]),_:1}),v(L,{class:"text-center hover:scale-[1.02] transition transform border border-blue-100"},{default:p(()=>[e("div",Gt,[t[14]||(t[14]=e("div",{class:"w-12 h-12 bg-gradient-to-r from-blue-400 to-cyan-500 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-md"},[e("span",{class:"text-xl text-white"},"📊")],-1)),e("h3",{class:F(["text-xl font-bold mb-1",U.value>=0?"text-green-600":"text-red-600"])},d(K(Math.abs(U.value),U.value>=0?"income":"expense")),3),t[15]||(t[15]=e("p",{class:"text-sm text-gray-600"},"Saldo Bersih",-1)),e("p",{class:F(["text-xs",U.value>=0?"text-green-500":"text-red-500"])},d(U.value>=0?"Surplus":"Defisit"),3)])]),_:1}),v(L,{class:"text-center hover:scale-[1.02] transition transform border border-purple-100"},{default:p(()=>[e("div",Ht,[t[16]||(t[16]=e("div",{class:"w-12 h-12 bg-gradient-to-r from-purple-400 to-pink-500 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-md"},[e("span",{class:"text-xl text-white"},"👤")],-1)),e("h3",Lt,d(fe.value.length),1),t[17]||(t[17]=e("p",{class:"text-sm text-gray-600"},"Transaksi Saya",-1))])]),_:1})]),e("div",qt,[v(u(Z),{href:a.route("master-data.categories.index"),class:"flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-r from-rose-400 via-pink-400 to-pink-500 text-white font-semibold shadow-md hover:shadow-lg hover:from-rose-500 hover:to-pink-600 transition-all duration-300 ease-in-out transform hover:-translate-y-0.5 active:scale-95"},{default:p(()=>[...t[18]||(t[18]=[e("span",{class:"text-lg"},"💗",-1),e("span",null,"Kategori",-1)])]),_:1},8,["href"]),v(u(Z),{href:a.route("master-data.accounts.index"),class:"flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-r from-pink-300 via-rose-400 to-rose-500 text-white font-semibold shadow-md hover:shadow-lg hover:from-pink-400 hover:to-rose-600 transition-all duration-300 ease-in-out transform hover:-translate-y-0.5 active:scale-95"},{default:p(()=>[...t[19]||(t[19]=[e("span",{class:"text-lg"},"🌸",-1),e("span",null,"Akun",-1)])]),_:1},8,["href"]),v(u(Z),{href:a.route("budgets.index"),class:"flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-r from-pink-200 via-rose-300 to-rose-400 text-white font-semibold shadow-md hover:shadow-lg hover:from-pink-300 hover:to-rose-500 transition-all duration-300 ease-in-out transform hover:-translate-y-0.5 active:scale-95 animate-pulse"},{default:p(()=>[...t[20]||(t[20]=[e("span",{class:"text-lg"},"💰",-1),e("span",null,"Kelola Anggaran",-1)])]),_:1},8,["href"])]),v(Ue,{title:"Data Transaksi",description:`Menampilkan ${se.value.length} dari ${o.value.length} transaksi`,columns:Se,data:se.value,loading:M.value,"show-actions":!0,pagination:!0,"items-per-page":10,onCreate:le,onEdit:oe,onDelete:re},{"column-type":p(({item:n})=>[e("div",Yt,[e("span",Qt,d(ue(n.type)),1),e("span",Wt,d(ie(n.type)),1)])]),"column-amount":p(({item:n})=>[e("div",Xt,[e("span",Zt,d(ue(n.type)),1),e("span",{class:F(["font-bold text-sm",ce(n.type)])},d(K(n.amount,n.type)),3)])]),"column-account.name":p(({item:n})=>[e("div",ea,[t[21]||(t[21]=e("span",{class:"text-lg"},"🏦",-1)),e("span",ta,d(n.account?.name),1)])]),"column-category.name":p(({item:n})=>[e("div",aa,[t[22]||(t[22]=e("span",{class:"text-lg"},"📁",-1)),e("span",sa,d(n.category?.name),1)])]),"column-transaction_date":p(({item:n})=>[e("div",na,[t[23]||(t[23]=e("span",{class:"text-lg"},"📅",-1)),e("span",la,d(de(n.transaction_date)),1)])]),"column-user.name":p(({item:n})=>[e("div",oa,[e("span",ra,d(n.user_id===u(b).id?"👤":"👥"),1),e("span",{class:F(["font-medium text-gray-700 text-sm",n.user_id===u(b).id?"text-blue-600":"text-green-600"])},d(n.user_id===u(b).id?"Saya":n.user?.name||"Partner"),3)])]),actions:p(({item:n})=>[v(I,{onClick:me=>oe(n),variant:"secondary",size:"sm",class:"!px-2 !py-2",disabled:!H(n),title:H(n)?"Edit transaksi":"Hanya dapat mengedit transaksi yang Anda buat"},{icon:p(()=>[...t[24]||(t[24]=[g("✏️",-1)])]),default:p(()=>[t[25]||(t[25]=g(" Edit ",-1))]),_:1},8,["onClick","disabled","title"]),v(I,{onClick:me=>re(n),variant:"danger",size:"sm",class:"!px-2 !py-2",disabled:!H(n),title:H(n)?"Hapus transaksi":"Hanya dapat menghapus transaksi yang Anda buat"},{icon:p(()=>[...t[26]||(t[26]=[g("🗑️",-1)])]),default:p(()=>[t[27]||(t[27]=g(" Hapus ",-1))]),_:1},8,["onClick","disabled","title"])]),_:1},8,["description","data","loading"]),o.value.length===0&&!M.value?(x(),y("div",ia,[e("div",ua,[t[30]||(t[30]=e("div",{class:"text-6xl mb-4"},"💰",-1)),t[31]||(t[31]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Belum ada transaksi",-1)),e("p",{class:"text-gray-600 mb-6 max-w-md mx-auto"}," Mulai dengan mencatat transaksi pertama untuk melacak keuangan "+d(A)),v(I,{onClick:le,class:"px-6 py-3"},{icon:p(()=>[...t[28]||(t[28]=[g("➕",-1)])]),default:p(()=>[t[29]||(t[29]=g(" Catat Transaksi Pertama ",-1))]),_:1})])])):w("",!0),v(pe,{show:P.value,"onUpdate:show":t[6]||(t[6]=n=>P.value=n),title:C.value?"Edit Transaksi":"Catat Transaksi Baru",description:C.value?"Perbarui informasi transaksi keuangan kita":"Catat transaksi baru untuk melacak keuangan bersama",icon:C.value?"✏️":"➕","confirm-text":C.value?"Perbarui":"Simpan","confirm-loading":u(l).processing,onConfirm:De,onClose:je,size:"lg"},{default:p(()=>[e("div",da,[e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("span",{class:"text-blue-400"},"📊"),g(" Jenis Transaksi "),e("span",{class:"text-red-500"},"*")],-1)),e("div",ca,[(x(),y(q,null,Y(Te,n=>e("button",{key:n.value,onClick:me=>u(l).type=n.value,class:F(["p-3 rounded-xl border-2 text-center transition-all font-medium text-sm",u(l).type===n.value?(n.value==="income"?"bg-green-100 text-green-700 border-green-400":n.value==="expense"?"bg-red-100 text-red-700 border-red-400":"bg-blue-100 text-blue-700 border-blue-400")+" scale-105 shadow-md":"bg-white border-gray-200 text-gray-500 hover:scale-102 hover:border-gray-300"])},[e("div",pa,d(n.icon),1),e("div",null,d(n.label.replace("💰 ","").replace("💸 ","").replace("🏦 ","")),1)],10,ma)),64))]),u(l).errors.type?(x(),y("p",ga,d(u(l).errors.type),1)):w("",!0)]),v(B,{modelValue:u(l).account_id,"onUpdate:modelValue":t[1]||(t[1]=n=>u(l).account_id=n),label:u(l).type==="income"||u(l).type==="savings"?"Akun Penerima":"Akun Sumber",placeholder:u(l).type==="income"||u(l).type==="savings"?"Pilih akun penerima":"Pilih akun sumber",options:S.value.map(n=>({value:n.id,label:n.name+(n.type==="joint"?" 👥":" 👤")})),error:u(l).errors.account_id,icon:"🏦",required:"",disabled:u(l).processing||S.value.length===0},null,8,["modelValue","label","placeholder","options","error","disabled"]),v(B,{modelValue:u(l).category_id,"onUpdate:modelValue":t[2]||(t[2]=n=>u(l).category_id=n),label:u(l).type==="income"?"Kategori Pemasukan":u(l).type==="savings"?"Tujuan Tabungan":"Kategori Pengeluaran",placeholder:u(l).type==="income"?"Pilih kategori pemasukan":u(l).type==="savings"?"Pilih tujuan tabungan":"Pilih kategori pengeluaran",options:X.value.map(n=>({value:n.id,label:n.name+(n.type==="joint"?" 👥":" 👤")})),error:u(l).errors.category_id,icon:"📁",required:"",disabled:u(l).processing||X.value.length===0},null,8,["modelValue","label","placeholder","options","error","disabled"]),v(te,{modelValue:u(l).amount,"onUpdate:modelValue":t[3]||(t[3]=n=>u(l).amount=n),label:"Jumlah",placeholder:u(l).type==="income"?"Contoh: 5000000":u(l).type==="savings"?"Contoh: 1000000":"Contoh: 150000",error:u(l).errors.amount,icon:"💰","account-type":"account_number",required:"",disabled:u(l).processing},null,8,["modelValue","placeholder","error","disabled"]),v(Ke,{modelValue:u(l).description,"onUpdate:modelValue":t[4]||(t[4]=n=>u(l).description=n),label:"Keterangan",placeholder:u(l).type==="income"?"Contoh: Gaji bulan Januari, Bonus project...":u(l).type==="savings"?"Contoh: Tabungan rumah, Dana liburan...":"Contoh: Belanja bulanan, Bayar listrik...",error:u(l).errors.description,icon:"📝",rows:3,"show-counter":!0,"max-length":255,required:"",disabled:u(l).processing},null,8,["modelValue","placeholder","error","disabled"]),v(ae,{modelValue:u(l).transaction_date,"onUpdate:modelValue":t[5]||(t[5]=n=>u(l).transaction_date=n),label:"Tanggal Transaksi",error:u(l).errors.transaction_date,icon:"📅",required:"",disabled:u(l).processing},null,8,["modelValue","error","disabled"]),e("div",{class:F(["p-4 rounded-2xl border",Ce.value])},[e("p",va,[e("span",xa,d(Fe.value),1),e("span",null,[e("strong",ya,d(Pe.value),1),g(" "+d(Ae.value),1)])])],2),u(l).hasErrors?(x(),y("div",fa,[...t[33]||(t[33]=[e("p",{class:"text-sm text-red-600 flex items-center gap-2"},[e("span",null,"⚠️"),g(" Terdapat kesalahan dalam pengisian form. Silakan periksa kembali input Anda. ")],-1)])])):w("",!0)])]),_:1},8,["show","title","description","icon","confirm-text","confirm-loading"]),v(pe,{show:D.value,"onUpdate:show":t[7]||(t[7]=n=>D.value=n),title:"Hapus Transaksi",description:k.value?`Apakah Anda yakin ingin menghapus transaksi ${k.value.description}?`:"Apakah Anda yakin ingin menghapus transaksi ini?",icon:"🗑️","confirm-text":"Hapus","cancel-text":"Batal","confirm-variant":"danger","confirm-loading":V.value,onConfirm:Ve,onClose:t[8]||(t[8]=n=>D.value=!1)},{default:p(()=>[e("div",ba,[t[42]||(t[42]=e("div",{class:"p-4 bg-gradient-to-r from-red-50 to-orange-50 border border-red-200 rounded-2xl"},[e("p",{class:"text-sm text-red-600 flex items-start gap-2"},[e("span",{class:"text-lg mt-0.5"},"⚠️"),e("span",null,[e("strong",{class:"block"},"Tindakan ini tidak dapat dibatalkan!"),g(" Transaksi yang dihapus akan mempengaruhi saldo akun dan laporan keuangan. ")])])],-1)),k.value?(x(),y("div",ka,[t[41]||(t[41]=e("h4",{class:"font-semibold text-gray-800 mb-2"},"Detail Transaksi:",-1)),e("div",_a,[e("div",null,[t[34]||(t[34]=e("span",{class:"text-gray-600"},"Jenis:",-1)),e("p",ha,d(ie(k.value.type)),1)]),e("div",null,[t[35]||(t[35]=e("span",{class:"text-gray-600"},"Jumlah:",-1)),e("p",{class:F(["font-bold",ce(k.value.type)])},d(K(k.value.amount,k.value.type)),3)]),e("div",null,[t[36]||(t[36]=e("span",{class:"text-gray-600"},"Akun:",-1)),e("p",wa,d(k.value.account?.name),1)]),e("div",null,[t[37]||(t[37]=e("span",{class:"text-gray-600"},"Kategori:",-1)),e("p",$a,d(k.value.category?.name),1)]),e("div",null,[t[38]||(t[38]=e("span",{class:"text-gray-600"},"Tanggal:",-1)),e("p",Ta,d(de(k.value.transaction_date)),1)]),e("div",null,[t[39]||(t[39]=e("span",{class:"text-gray-600"},"Dicatat Oleh:",-1)),e("p",Sa,d(k.value.user_id===u(b).id?"Saya":k.value.user?.name||"Partner"),1)]),e("div",Ca,[t[40]||(t[40]=e("span",{class:"text-gray-600"},"Keterangan:",-1)),e("p",Fa,d(k.value.description),1)])])])):w("",!0)])]),_:1},8,["show","description","confirm-loading"])])])]),_:1}))}},Ua=Oe(Pa,[["__scopeId","data-v-0425059b"]]);export{Ua as default};
